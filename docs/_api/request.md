---
title: Request API
permalink: /docs/request-api/
---

<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### Table of Contents

-   [Request][1]
    -   [accepts][2]
    -   [acceptsEncoding][3]
    -   [contentLength][4]
    -   [getContentType][5]
    -   [date][6]
    -   [href][7]
    -   [id][8]
    -   [getPath][9]
    -   [getQuery][10]
    -   [time][11]
    -   [version][12]
    -   [header][13]
    -   [trailer][14]
    -   [is][15]
    -   [isChunked][16]
    -   [isKeepAlive][17]
    -   [isSecure][18]
    -   [isUpgradeRequest][19]
    -   [isUpload][20]
    -   [toString][21]
    -   [userAgent][22]
    -   [startHandlerTimer][23]
    -   [endHandlerTimer][24]
    -   [connectionState][25]
    -   [getRoute][26]
-   [Log][27]

## Request

**Extends http.IncomingMessage**

Wraps all of the node
[http.IncomingMessage][28]
APIs, events and properties, plus the following.

### accepts

Check if the Accept header is present, and includes the given type.
When the Accept header is not present true is returned.
Otherwise the given type is matched by an exact match, and then subtypes.

**Parameters**

-   `types` **([String][29] \| [Array][30]&lt;[String][29]>)** an array of accept type headers

**Examples**

_You may pass the subtype such as html which is then converted internally
to text/html using the mime lookup table:_

```javascript
// Accept: text/html
req.accepts('html');
// => true

// Accept: text/*; application/json
req.accepts('html');
req.accepts('text/html');
req.accepts('text/plain');
req.accepts('application/json');
// => true

req.accepts('image/png');
req.accepts('png');
// => false
```

Returns **[Boolean][31]** is accepteed

### acceptsEncoding

Checks if the request accepts the encoding type(s) specified.

**Parameters**

-   `types` **([String][29] \| [Array][30]&lt;[String][29]>)** an array of accept type headers

Returns **[Boolean][31]** is accepted encoding

### contentLength

Returns the value of the content-length header.

Returns **[Number][32]** 

### getContentType

Returns the value of the content-type header. If a content-type is not
set, this will return a default value of `application/octet-stream`

Returns **[String][29]** content type

### date

Returns a Date object representing when the request was setup.
Like `time()`, but returns a Date object.

Returns **[Date][33]** date when request began being processed

### href

Returns the full requested URL.

**Examples**

```javascript
// incoming request is http://localhost:3000/foo/bar?a=1
server.get('/:x/bar', function(req, res, next) {
    console.warn(req.href());
    // => /foo/bar/?a=1
});
```

Returns **[String][29]** 

### id

Returns the request id. If a `reqId` value is passed in,
this will become the requestâ€™s new id. The request id is immutable,
and can only be set once. Attempting to set the request id more than
once will cause restify to throw.

**Parameters**

-   `reqId` **[String][29]** request id

Returns **[String][29]** id

### getPath

Returns the cleaned up requested URL.

**Examples**

```javascript
// incoming request is http://localhost:3000/foo/bar?a=1
server.get('/:x/bar', function(req, res, next) {
    console.warn(req.path());
    // => /foo/bar
});
```

Returns **[String][29]** 

### getQuery

Returns the raw query string. Returns empty string
if no query string is found.

**Examples**

```javascript
// incoming request is /foo?a=1
req.getQuery();
// => 'a=1'
```

_If the queryParser plugin is used, the parsed query string is
available under the req.query:_

```javascript
// incoming request is /foo?a=1
server.use(restify.plugins.queryParser());
req.query;
// => { a: 1 }
```

Returns **[String][29]** query

### time

The number of ms since epoch of when this request began being processed.
Like date(), but returns a number.

Returns **[Number][32]** time when request began being processed in epoch:
                   ellapsed milliseconds since
                   January 1, 1970, 00:00:00 UTC

### version

Returns the accept-version header.

Returns **[String][29]** 

### header

Get the case-insensitive request header key,
and optionally provide a default value (express-compliant).
Returns any header off the request. also, 'correct' any
correctly spelled 'referrer' header to the actual spelling used.

**Parameters**

-   `key` **[String][29]** the key of the header
-   `defaultValue` **[String][29]?** default value if header isn't
                                      found on the req

**Examples**

```javascript
req.header('Host');
req.header('HOST');
req.header('Accept', '*\/*');
```

Returns **[String][29]** header value

### trailer

Returns any trailer header off the request. Also, 'correct' any
correctly spelled 'referrer' header to the actual spelling used.

**Parameters**

-   `name` **[String][29]** the name of the header
-   `value` **[String][29]** default value if header isn't found on the req

Returns **[String][29]** trailer value

### is

Check if the incoming request contains the `Content-Type` header field,
and if it contains the given mime type.

**Parameters**

-   `type` **[String][29]** a content-type header value

**Examples**

```javascript
// With Content-Type: text/html; charset=utf-8
req.is('html');
req.is('text/html');
// => true

// When Content-Type is application/json
req.is('json');
req.is('application/json');
// => true

req.is('html');
// => false
```

Returns **[Boolean][31]** is content-type header

### isChunked

Check if the incoming request is chunked.

Returns **[Boolean][31]** is chunked

### isKeepAlive

Check if the incoming request is kept alive.

Returns **[Boolean][31]** is keep alive

### isSecure

Check if the incoming request is encrypted.

Returns **[Boolean][31]** is secure

### isUpgradeRequest

Check if the incoming request has been upgraded.

Returns **[Boolean][31]** is upgraded

### isUpload

Check if the incoming request is an upload verb.

Returns **[Boolean][31]** is upload

### toString

toString serialization

Returns **[String][29]** serialized request

### userAgent

Returns the user-agent header.

Returns **[String][29]** user agent

### startHandlerTimer

Start the timer for a request handler.
By default, restify uses calls this automatically for all handlers
registered in your handler chain.
However, this can be called manually for nested functions inside the
handler chain to record timing information.

**Parameters**

-   `handlerName` **[String][29]** The name of the handler.

**Examples**

_You must explicitly invoke
endHandlerTimer() after invoking this function. Otherwise timing
information will be inaccurate._

```javascript
server.get('/', function fooHandler(req, res, next) {
    vasync.pipeline({
        funcs: [
            function nestedHandler1(req, res, next) {
                req.startHandlerTimer('nestedHandler1');
                // do something
                req.endHandlerTimer('nestedHandler1');
                return next();
            },
            function nestedHandler1(req, res, next) {
                req.startHandlerTimer('nestedHandler2');
                // do something
                req.endHandlerTimer('nestedHandler2');
                return next();

            }...
       ]...
    }, next);
});
```

Returns **[undefined][34]** no return value

### endHandlerTimer

End the timer for a request handler.
You must invoke this function if you called `startRequestHandler` on a
handler. Otherwise the time recorded will be incorrect.

**Parameters**

-   `handlerName` **[String][29]** The name of the handler.

Returns **[undefined][34]** no return value

### connectionState

Returns the connection state of the request. Current possible values are:

-   `close` - when the request has been closed by the clien

Returns **[String][29]** connection state (`"close"`)

### getRoute

Returns the route object to which the current request was matched to.

**Examples**

_Route info object structure:_

```javascript
{
 path: '/ping/:name',
 method: 'GET',
 versions: [],
 name: 'getpingname'
}
```

Returns **[Object][35]** route

## Log

If you are using the [RequestLogger][36] plugin, the child logger
will be available on `req.log`:

```js
function myHandler(req, res, next) {
  var log = req.log;

  log.debug({params: req.params}, 'Hello there %s', 'foo');
}
```

The child logger will inject the request's UUID in the `req._id` attribute of
each log statement. Since the logger lasts for the life of the request, you can
use this to correlate statements for an individual request across any number of
separate handlers.


[1]: #request

[2]: #accepts

[3]: #acceptsencoding

[4]: #contentlength

[5]: #getcontenttype

[6]: #date

[7]: #href

[8]: #id

[9]: #getpath

[10]: #getquery

[11]: #time

[12]: #version

[13]: #header

[14]: #trailer

[15]: #is

[16]: #ischunked

[17]: #iskeepalive

[18]: #issecure

[19]: #isupgraderequest

[20]: #isupload

[21]: #tostring

[22]: #useragent

[23]: #starthandlertimer

[24]: #endhandlertimer

[25]: #connectionstate

[26]: #getroute

[27]: #log

[28]: https://nodejs.org/api/http.html

[29]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String

[30]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array

[31]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean

[32]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number

[33]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Date

[34]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/undefined

[35]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object

[36]: #bundled-plugins
